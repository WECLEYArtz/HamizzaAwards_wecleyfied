const dialogues = {
    0: {
        text: "Bro thought he can leave just like that üò≠üôèüôè Choose wisely...",
        options: {
            "1": "Beg",
            "2": "Be logical",
            "3": "Say something random",
            "4.1": "The right choice"
        }
    },
    1: {
        text: "Begging... me? that shit ain't working on meüò≠üò≠üò≠üò≠'",
        avatar: "../../docs/reactions/hamid sob.png",
        options: {
            "1-1": "I have a family!",
            "1-2": "Hamizza, please! mercy!!",
            "1-3": "Please don't take my soul, it's already broken from studying.",
            "1-4": "I don't have family!"
        }
    },
    "1-1": {
        text: "You do??",
        avatar: "../../docs/reactions/holy fuck.png",
        popupImg: "../../docs/reactions/buzz.gif",
        options: {
            "1-1-1": "There all I have!",
            "1-1-2": "Please, think of my children!"
        }
    },
    "1-1-1": {
        text: "*they're",
        avatar: "../../docs/reactions/nerd.png",
        options: {}
    },
    "1-1-2": {
        avatar:"../../docs/reactions/jew.png",
        text: "Free labor for Hamizza Inc. Noted.",
        options: {}
    },
    "1-2": {
        avatar: "../../docs/reactions/uwu.png",
        text:"You're welcome!!",
        popupImg: "../../docs/reactions/merci.png",
        options: {},
    },
    "1-3":{
        avatar: "../../docs/reactions/we fuck.png",
        text:"Damn that's crazy",
        popupImg:"../../docs/reactions/don't give.png"
    },
    
    "1-4": {
        text: "So... no one will notice if you disappeared?",
        avatar: "../../docs/reactions/jew.png",
        popupImg: "../../docs/reactions/fortnite.mp4",
        options: {
            "1-4-1": "I'm alone!"
        }
    },
    "1-4-1": {
        text: "HHHHHHHHHH",
        avatar: "../../docs/reactions/hamid joy.png",
        options: {
            "1-4-1-1": "no one cares about me...."
        }
    },
    "1-4-1-1": {
        text: "HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH",
        popupImg: "../../docs/reactions/pointing.png",
        avatar: "../../docs/reactions/pointing2.png",
        options: {}
    },

    2: {
        text: "Logic isn't the best choice in illogical situations.",
        options: {
            "2-1": "Hamizza, if you take my soul, who'll visit your site?",
            "2-2": "Hey there üôã‚Äç‚ôÇÔ∏è I have a gun.",
            "2-3": "I'll just sacrifice my friend instead."
        }
    },
    "2-1": {
        text: "Or maybe it is...",
        avatar: "../../docs/reactions/shit.png",
        options: {}
    },
    "2-2": {
        text: "...",
        avatar: "../../docs/reactions/shit.png",
        options: {
            "2-2-1": "I'm not afraid to use it!"
        }
    },
    "2-2-1": {
        text: "I am.",
        avatar: "../../docs/reactions/run.png",
        popupImg: "../../docs/reactions/gigachad.png", 
        options: {}
    },
    "2-3": {
        text: "That was a smart move! Name and address?",
        avatar: "../../docs/reactions/think.png",
        popupImg: "../../docs/reactions/jew.png", 
        options: {
            "2-3-1": "*Remember you don't have friends*",
            "2-3-2": "User's information (There is no other choice idiot üòÇ)",//5asni n9ad l5at for (   ) 
            "2-3-3": "<input textarea> //need a real input hh" // need a real input hh
        }
    },
    "2-3-1": {
        text: "*Start laughing like it's not the same for me*",
        avatar: "../../docs/reactions/pointing.png",
        options: {}
    },
    "2-3-2": {
        text: "Nice! You accepted your fate! What a kind personüòÇ",
        avatar: "../../docs/reactions/laugh.png",
        options: {}
    },
    "2-3-3": {
        text: "This website's not that advanced broüò≠",
        avatar: "../../docs/reactions/hamid sob2.png",
        options: {
            "2-3-3-1": "What happened to what I've typed?"
        }
    },
    "2-3-3-1": {
        text: "We don't know we're not AI, this site barely handle itself.",
        avatar: "../../docs/reactions/hamid sob.png",
        options: {}
    },
    3: {
        text: "Go ahead, show me your cock",
        avatar: "../../docs/reactions/fempizza.png",
        options: {
            "3-1": "I play Genshin, I don't have a life to give it (still not worse than you).",
            "3-2": "I can offer you 20 likes on Instagram.",
            "3-3": "Here is a joke and spare my life.",
            "3-4": "you mean your cook?"
        }
    },
    "3-1": {
        text: "But... you have organs :D!",
        avatar: "../../docs/reactions/uwu.png",
        options: {
            "3-1-1": "Kidney? I don't have one.",
            "3-1-2": "But I'm using them!"
        }
    },
    "3-1-1": {
        text: "Let me see.",
        avatar: "../../docs/reactions/see.png", // Avatar appears
        options: {}
    },
    "3-1-2": {
        avatar: "../../docs/reactions/pizza.png",
        text: "Not for long.",
        options: {}
    },
    "3-2": {
        avatar: "../../docs/reactions/hamid sob2.png",
        text: "No way bro's life equal to 20 likeüò≠üò≠.",
        options: {}
    },
    "3-3": {
        text: "Sir 3allah",
        avatar: "../../docs/reactions/sir.png",
        options: {
            "3-3-1": "Why 6 afraid of 7?",
            "3-3-2": "Why don't programmers like nature?"
        }
    },
    "3-3-1": {
        text: "Why?",
        avatar: "../../docs/reactions/think.png",
        options: {
            "3-3-1-1": "Because 7 was black.",
            "3-3-1-2": "Because 7 eight 9üòÇ"
        }
    },
    "3-3-1-1": {
        avatar: "../../docs/reactions/laugh.png",
        text: "üò≠",
        options: {}
    },
    "3-3-1-2": {
        avatar: "../../docs/reactions/pizza.png",
        text: "I don't get it.",
        options: {
            "3-3-1-2-1": "7 8 9, 7 ate 9üòÇüòÇüòÇ"
        }
    },
    "3-3-1-2-1": {
        text: "I mean I don't get how you call this a \"joke.\"",
        options: {
            "3-3-1-2-1-1": "...",
        }
    },
    "3-3-1-2-1-1" : {
        popupImg: "../../docs/reactions/gun.png",
        text:"Kill them"
    },
    "3-3-2": {
        text: "Why?",
        avatar: "../../docs/reactions/think.png",
        options: {
            "3-3-2-1": "Because they're fucking idiots.",
            "3-3-2-2": "It has too many bugsüòÇüòÇ"
        }
    },
    "3-3-2-1": {
        text: "LOL! alright here's a joke: why did you stop breathing?",
        avatar: "../../docs/reactions/hamid joy.png",
        options: {
            "3-3-2-1-1": "..."
        }
    },
    "3-3-2-1-1": {
        text: "Because the idiot removed the wrong organüòÇüòÇüòÇ.",
        avatar: "../../docs/reactions/hamid joy2.png",
        options: {}
    },
    "3-3-2-2": {
        avatar: "../../docs/reactions/pizza.png",
        text: "... yeah you're dead.",
        options: {}
    },
    "3-4":{
        text:" ",
        avatar:"../../docs/reactions/shit.png",
        popupImg:"../../docs/reactions/oh right.mp4"
    },
    4.1:{
        text: "No way, bro... you fell for that?",
        avatar:"../../docs/reactions/sob.png",
        options: {
            "4" : "I have a plan"
        }
    },
    4: {
        text: "A plan?",
        avatar:"../../docs/reactions/think.png",
        options: {
            "4-1": "It starts with N, I, and then the G",
            "4.1-2": "[Right choice]",
            "4-3": "*a plane"
        }
    },
    "4-1": {
        text: "Racism won't help you.",
        avatar:"../../docs/reactions/random.png",
        options: {
            "4-1-1": "And there is an E and R."
        }
    },
    "4-1-1": {
        text: "At least you've earned my respect.",
        avatar:"../../docs/reactions/sir.png",
        options: {
            "4-1-1-1": "N I G E R U N D A Y O!!!",
            "4-1-1-2": "Nigeria!",
            "4-1-1-3": "FIRED CHICKEN!",
            "4-1-1-4": "N I G G E R!"
        }
    },
    "4-1-1-1": {
        text: "NIGERUNDAYO!!!",
        avatar: "../../docs/reactions/jojo-zoom.png",
        popupImg: "../../docs/reactions/joseph-nigerundayo.png", 
        options: {}
    },
    "4-1-1-2": {
        text: "There was only one wrong answer, and still you chose it üò≠.",
        options: {}
    },
    "4-1-1-3": {
        text: "Fried chicken doesn't start wit-",
        popupImg: "../../docs/reactions/n.mp4",
        options: {}
    },
    "4-1-1-4": {
        text: "HOW DID HE FIND THIS PLACE!?",
        popupImg: "../../docs/reactions/american-cop-running.mp4", 
        options: {}
    },
    "4.1-2" : {
        text: "NO WAY YOU FELL FOR THAT AGAINüò≠",
        options:{
            "4-2": "..."
        }
    },
    "4-2": {
        text: "You know what's the right choice?",
        options: {
            "4-2-1": "Yeah I'm gonna just kill myself",
            "4-2-2": "No..."
        }
    },
    "4-2-1": {
        text: "Any last words?",
        options: {
            "4-2-1-1": "Be careful guys, it's a sca-",
            "4-2-1-2": "I regret visiting this website."
        }
    },
    "4-2-1-1": {
        text: "Cause of Death: Sold soul for 10 Pizzoin. Last Words: 'Worth it.'... what a kind person!",
        options: {}
    },
    "4-2-1-2": {
        text: "Regret visiting the website after (account age).",
        options: {}
    },
    "4-2-2": {
        text: "Good.",
        popupImg: "../../docs/reactions/gun-shot.png", 
        options: {}
    },
    "4-3": {
        text: "üòÄ?",
        options: {
            "4-3-1": "6/11 + 3/11?"
        }
    },
    "4-3-1": {
        text: "Oh oh...",
        options: {}
    }
};

const avatarContainer = document.querySelector('.avatar-container');
const avatarImg = document.getElementById('avatar');
const popup = document.getElementById('popup');
const popupImg = document.getElementById('popup-img');
const dialogText = document.getElementById('dialog-text');
const choicesContainer = document.getElementById('choices-container');

let currentDialogueId = "0";

function renderDialogue(id) {
    const dialogue = dialogues[id];
    if (!dialogue) return;

    dialogText.textContent = dialogue.text;

    if (dialogue.avatar) {
        avatarImg.src = dialogue.avatar;
    }

    if (dialogue.popupImg) {
        if (dialogue.popupImg.endsWith('.mp4')) {
            const video = document.createElement('video');
            video.src = dialogue.popupImg;
            video.autoplay = true;
            video.loop = true;
            video.onloadedmetadata = () => animatePopup(video);
            popup.innerHTML = '';
            popup.appendChild(video);
        } else {
            popupImg.src = dialogue.popupImg;
            popupImg.onload = () => animatePopup(popupImg);
            popup.innerHTML = '';
            popup.appendChild(popupImg);
        }
        popup.style.opacity = "0";
    } else {
        avatarContainer.style.transform = "translateX(0)";
        popup.style.transform = "translateX(0)";
        popup.style.opacity = "0";
    }

    renderChoices(dialogue.options);
}

function animatePopup(mediaElement) {
    const avatarRect = avatarImg.getBoundingClientRect();
    const containerRect = avatarContainer.getBoundingClientRect();
    const gap = 20;

    const offset = avatarRect.right - containerRect.left + gap;

    popup.style.position = 'absolute';
    popup.style.transform = `translateX(0)`;
    popup.style.opacity = "0";

    setTimeout(() => {
        popup.style.transition = "transform 0.5s ease, opacity 0.5s ease";
        popup.style.transform = `translateX(${offset}px)`;
        popup.style.opacity = "1";
    }, 50);
}

function renderChoices(options) {
    choicesContainer.innerHTML = "";

    Object.keys(options).forEach(key => {
        const btn = document.createElement('button');
        btn.textContent = options[key];
        btn.className = "choice-btn";
        btn.onclick = () => {
            currentDialogueId = key;
            renderDialogue(currentDialogueId);
        };
        choicesContainer.appendChild(btn);
    });
}

renderDialogue(currentDialogueId);
